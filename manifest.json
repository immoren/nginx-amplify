{
  "jpsVersion": "0.99",
  "jpsType": "update",
  "build": "20170718",
  "application": {
    "id": "nginx-amplify-agent",
    "targetNodes": {
      "nodeType": [
        "nginxphp",
        "nginxphp-dockerized"
      ]
    },
    "name": "NGINX Amplify",
    "version": "latest",
    "homepage": "https://www.nginx.com/products/nginx-amplify/",
    "categories": [
      "apps/dev-and-admin-tools"
    ],
    "logo": "https://raw.githubusercontent.com/jelastic-jps/nginx-amplify/master/images/nginx-amplify-logo.png",
    "description": {
      "text": "NGINX Amplify is a tool for comprehensive monitoring of the NGINX-PHP application servers, which can be used to proactively detect and fix issues related to running and scaling applications.<div class='warning-lower' style='color:#b7c3da'>To get an API key, create an account at <a href=\"https://amplify.nginx.com/signup/\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Amplify website</a> and copy your key from the start page or account settings.</div>",
      "short": "NGINX Amplify is a tool for monitoring, proactively detecting, and fixing issues related to running and scaling NGINX-based applications."
    },
    "settings": {
      "fields": [
        {
          "type": "string",
          "name": "api_key",
          "caption": "API key",
          "vtype": "alphanum",
          "vtypeText": "Alphanumeric input only.",
          "required": true,
          "default": "0000000000000000000000000000000000000000"
        }
      ]
    },
    "onInstall": {
        "executeShellCommands": [
          {
            "nodeGroup": "cp",
            "commands": [
              "curl -L -O https://github.com/nginxinc/nginx-amplify-agent/raw/master/packages/install.sh",
              "API_KEY='${settings.api_key}' sh ./install.sh",
              "curl -fsSL 'https://raw.githubusercontent.com/jelastic-jps/nginx-amplify/master/configs/stub_status.conf' -o /etc/nginx/conf.d/stub_status.conf",
              "kill -HUP `cat /var/run/nginx.pid`",
              "chkconfig amplify-agent on"
            ],
            "user": "root"
          }
        ]
    },
    "onUninstall": {
        "executeShellCommands": [
          {
            "nodeGroup": "cp",
            "commands": [
              "yum remove nginx-amplify-agent",
              "rm -f /etc/nginx/conf.d/stub_status.conf",
              "kill -HUP `cat /var/run/nginx.pid`"
            ],
            "user": "root"
          }
        ]
    },
    "success": {
        "text": "NGINX Amplify add-on was applied to ${env.url}. You can return to the Amplify dashboard to collect and visualize data on your NGINX-PHP instance(s) hosted at Jelastic.",
        "email": "NGINX Amplify add-on was applied to ${env.url}. You can return to the Amplify dashboard to collect and visualize data on your NGINX-PHP instance(s) hosted at Jelastic."
    }
  }
}
